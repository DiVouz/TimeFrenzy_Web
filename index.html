<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<link rel="icon" href="images/icon.png">
	<title>Time Frenzy</title>
</head>

<style>
	.white-an{
		background: #FFFFFF;
	}
	.blue-grey-an{
		box-shadow: -6px 6px 7px #607D8B;
		background: #263238;
	}
	.deep-orange-an{
		background: #FF6E40;
	}
	.logo-name{
		font-weight: bold;
		color: #FFFFFF;
	}
	.large-button-me{
		background-color: #FF6E40;
	    color: #FFFFFF;
	    text-align: center;
	    font-size: 16px;
	    font-weight: bold;
	    border: none;
	    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
	}
	.button-lvl{
	    padding: 14px 100px;
	}
	.button-comp{
	    padding: 14px 75px;
	}
	.square-buttons{
		background-color: #FF6E40;
	    text-align: center;
	    padding: 12px;
    	padding-bottom: 8px;
	    border: none;
	    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
	}
	.large-button-me:hover {
	    background-color: #DD2C00;
	}
	.square-buttons:hover {
	    background-color: #DD2C00;
	}
	.large-button-me:focus {
	    background-color: #DD2C00;
	}
	.square-buttons:focus {
		background-color: #DD2C00;
	}
	.large-button-me:active {
	  background-color: #DD2C00;
	  box-shadow: 0 4px #666;
	  transform: translateY(4px);
	}
	.square-buttons:active {
	  background-color: #DD2C00;
	  box-shadow: 0 4px #666;
	  transform: translateY(4px);
	}
</style>

<body class="grey lighten-1" onLoad="onBodyLoad()">

	<div class="container blue-grey-an" style="padding-top:15px">
		<audio id="music">
		  <source src="music.wav" type="audio/wav">
		</audio>
		<div class="row">

			<div class="col l2 center-align">
			</div>
			
			<!-- Static -->
			<!-- Logo,icons -->
			<div class="col l8 s12 center-align">
				<div class="row">
					<div class="col l6 s6 left-align">
						<img id="backButton" src="images/back.png" alt="back" onClick="back()" style="display:none;"">
					</div>
					<div class="col l6 s6 right-align">
						<img id="muteButton" src="images/volume.png" alt="music" onClick="muteMusic()">
					</div>
				</div>
				<div class="row">
					<h3 class="logo-name">Time Frenzy</h3>
				</div>
				<div id="image_logo" class="row">
					<img src="images/TimeFrenzy_Logo.gif" width="30%" height="30%" alt="logo">
				</div>

				<!-- Changeable -->
				<!-- MainMenu -->
				<div class="row" id="mainMenu">
					<div class="row" style="margin-top:70px;">
						<button class="large-button-me button-lvl" onClick="play()">LEVELS</button>
					</div>
					<div class="row">
						<a href="#" target="_blank"><button class="large-button-me button-comp">COMPETITIVE</button></a>
					</div>
					<div class="row" style="margin-top:90px;">
						<div class="col l2 s2 center-align"></div>

						<div class="col l2 s2 center-align">
							<a href="#" target="_blank"><button class="square-buttons"><img src="images/leaderboard.png" width="40px" height="40px" alt="leaderboard"></button></a>
						</div>

						<div class="col l1 s1 center-align"></div>

						<div class="col l2 s2 center-align">
							<button class="square-buttons" onClick="settings()"><img src="images/settings.png" width="40px" height="40px" alt="settings"></button>
						</div>

						<div class="col l1 s1 center-align"></div>

						<div class="col l2 s2 center-align">
							<button class="square-buttons" onClick="info()"><img src="images/info.png" width="40px" height="40px" alt="info"></button>
						</div>

						<div class="col l2 s2 center-align"></div>
					</div>
				</div>

				<!-- InfoTab -->
				<div class="row" id="infoMenu" style="margin-top:50px; margin-bottom:0px; display:none; color:white;">
					<img src="https://avatars2.githubusercontent.com/u/18709358?s=60&amp;v=4" class="avatar float-left mr-2" alt="" width="50" height="50">
					<img src="https://avatars0.githubusercontent.com/u/9154514?s=60&amp;v=4" class="avatar float-left mr-2" alt="" width="50" height="50">
				</div>

				<!-- SettingsTab -->
				<div class="row" id="settingsMenu" style="margin-top:50px; margin-bottom:0px; display:none; color:white;">
					<div>
						Settings
					</div>
				</div>

				<!-- LevelsTab -->
				<div class="row" id="levelsMenu" style="display:none; color:white;">
					<div class="row" style="margin-top:50px; margin-bottom:0px">
						<h5><b><span id="best"></span></b></h5>
					</div>
					<div class="row">
						<h5><b><span id="lap"></span></b></h5>
						<h1 style="margin-top:0px"><b>
							<span id="sec">0</span> : <span id="ms">0</span>
						</b></h1>
					</div>
					<div class="row">
						<button class="large-button-me button-comp" onClick="onPlayClicked()">PLAY</button>
					</div>
				</div>

				<!-- Static -->
				<!-- Google_play -->
				<div class="row" style="margin-top:50px;">
					<a href="#" target="_blank"><img src="images/google-play.png" width="40%" height="40%" alt="googleplay"></a>
				</div>
			</div>

			<div class="col l2 center-align">
			</div>
		</div>
	</div>
	<footer class="page-footer blue-grey-an">
        <div class="container">
            <div class="row">
            	<div class="col l6 s12">
                	<h5 class="white-text">Time Frenzy | Stopwatch game</h5>
                	<p class="grey-text text-lighten-4">Download full game at <a href="#" target="_blank">Google Play</a>.</p>
              </div>
            </div>
          </div>
          <div class="footer-copyright" style="border-top:solid 1px #37474F;">
            <div class="container">
            	Â© 2018 Copyright MadonnasPlays
            </div>
        </div>
    </footer>
</body>

<script>
//Tabs
var mainMenu;
var infoMenu;
var settingsMenu;
var levelsMenu;
var imageLogo;
//TabsOn
var mainMenuOn;
var infoMenuOn;
var settingsMenuOn;
var levelsMenuOn;

//Audio
var audio;

//Buttons
var backButton;
var muteButton;

//PlayTab
var lastFrame = null;
var started = false;
var clicked = false;
var sec_elem;
var ms_elem;
var best_elem;
var lap_elem;
var sec = 0;
var ms = 0;
var bestscore = 1000;

function onBodyLoad(){
	//Tabs
	mainMenu = document.getElementById("mainMenu");
	infoMenu = document.getElementById("infoMenu");
	settingsMenu = document.getElementById("settingsMenu");
	levelsMenu = document.getElementById("levelsMenu");
	imageLogo = document.getElementById("image_logo");
	
	//fetch timer elements
	ms_elem = document.getElementById('ms');
	sec_elem = document.getElementById('sec');
	lap_elem = document.getElementById('lap');
	best_elem = document.getElementById('best');
	
	//TabsOn
	mainMenuOn = true;
	infoMenuOn = false;
	settingsMenuOn = false;
	levelsMenuOn = false;

	//Audio
	audio = document.getElementById("music");
	audio.loop = true;
    audio.load();
	//audio.play();
	
	
	//StaticButtons
	muteButton = document.getElementById("muteButton");
	backButton = document.getElementById("backButton");
	
	muteMusic();
}

//MuteButton
function muteMusic(){
	if (muteButton.getAttribute('src') == "images/volume.png"){
		audio.pause();
		muteButton.src = "images/volume_off.png";
	}else if(muteButton.getAttribute('src') == "images/volume_off.png"){
		audio.play();
		muteButton.src = "images/volume.png";
	}
}

//infoButton
function info(){
	mainMenu.style.display = "none";
	infoMenu.style.display = "block";
	backButton.style.display = "block";
	mainMenuOn = false;
	infoMenuOn = true;
}

//settingsButton
function settings(){
	mainMenu.style.display = "none";
	settingsMenu.style.display = "block";
	backButton.style.display = "block";
	mainMenuOn = false;
	settingsMenuOn = true;
}

//LevelsButton
function play(){
	mainMenu.style.display = "none";
	imageLogo.style.visibility="hidden"
	levelsMenu.style.display = "block";
	backButton.style.display = "block";
	mainMenuOn = false;
	levelsMenuOn = true;
}

//BackButton
function back(){
	if(infoMenuOn){
		mainMenu.style.display = "block";
		infoMenu.style.display = "none";
		backButton.style.display = "none";
		mainMenuOn = true;
		infoMenuOn = false;
	}else if(levelsMenuOn){
		mainMenu.style.display = "block";
		levelsMenu.style.display = "none";
		backButton.style.display = "none";
		imageLogo.style.visibility="visible"
		mainMenuOn = true;
		levelsMenuOn = false;
	}else if(settings){
		mainMenu.style.display = "block";
		settingsMenu.style.display = "none";
		backButton.style.display = "none";
		mainMenuOn = true;
		settingsMenuOn = false;
	}
}

//PlayTab
function onPlayClicked(){
	var roundms;
	var points;
	
	if(!started && !clicked){
		started = true;
		lastFrame = null;
		window.requestAnimationFrame(step);
	}else if(started && !clicked) {
		started = false;
		clicked = true;
		
		roundms = Math.round(ms);
		points = calculateScore(roundms);
		lap_elem.innerHTML = points;
		ms_elem.innerHTML = roundms;
  		sec_elem.innerHTML = sec;
		
		if(points < bestscore) {
			bestscore = points;
			best_elem.innerHTML = "Best: " + bestscore;
		}
		
	}else if(!started && clicked) {
		clicked = false;
		ms = 0;
		sec = 0;
		ms_elem.innerHTML = 0;
  		sec_elem.innerHTML = 0;
	}
}

function calculateScore(roundMs){
	var points;
	if(roundMs <= 500){
		points = roundMs;
		return points;
	}else{
		points = 1000 - roundMs;
		return points;
	}
}

function step(timestamp) {
	if (!lastFrame) lastFrame = timestamp;
	var this_frame = timestamp - lastFrame;
	lastFrame = timestamp;
	ms += this_frame;
	
	if(ms > 1000){
    	sec++;
    	ms = 0;
    }
	if(sec >= 60) sec = 0;
  	if(started) {
  		ms_elem.innerHTML = Math.round(ms);
 	 	sec_elem.innerHTML = sec;
  		window.requestAnimationFrame(step);
  	}
}
</script>

</html>
